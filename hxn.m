function F = hxn(x)

% pa = 101325*(1-H/44330)^(5.253);
Ma = 0.826; H = 1000;   %altura (m)
Ta = 288.15 - 0.0065*H;      % temperatura del aire atmosf?ico 

thick = 0.05;      %Thickness of heat ex. fin [m]
DHX = 7850;        %Densidad del material intercambiadores [kg/m^3]
Ce = 0.7;          %Consumo espec?ico de combustible [kg/h/N]
Tauo = 2;          %Tiempo de vuelo (h)
g = 9.81;          

K = 0.5;             %lift ratio

p1 = 364.7;        %s kPa

pic = 1.73; pit = 6.23; nc = 0.7; nt = 0.7; nm = 0.8;           %s
p6 = pic*p1; 

KHX1 = 100; KHX2 = 100; KHR1 = 100; KHR2 = 1000; Kco = 1000;    %s

z1 = (pic^(0.286)-1)/nc;  z2 = nt*(1-pit^(-0.286));                %s

AHX1 = x(1);
AHX2 = x(2);
AHR1 = x(3);
AHR2 = x(4);
Aco = x(5);
m0 = x(6);
m1 = x(7);
m2 = x(8);
L1 = x(9);   
L2 = x(10);
L3 = x(11);
L4 = x(12);

Q = 7000; Q0 = 7000;          %s J/s

w10 = 0.003; w1 = 0.019; w6 = w10; w4r = w1;     %s
dw = w1 - w10 ;               %s
gamma = 2260.00 ;  % J/kg   calor latente de vaporizaci? del agua 

T1 = 247.85;       %s °C
T11 = 40.1;        %s °C
                        
T4r = 273.15 + 235/( 7.45/log(p6/(610*(0.622/w4r+1))) - 1 );  %s
Tp4 = T4r; Tast4 = T4r;                                            %s
T6  = 273.15 + 235/( 7.45/log(p6/(610*(0.622/w6 +1))) - 1 );     %s
T7 = T6;                                                           %s
T12 = T11;                                                         %s

Cp = 1005;                                              %s  J/kg°C
Tast10 = 20;  T10 = Tast10 - Q0/(m0*Cp);                %s  °C
dT =  T4r - T6;                                         %s  °C
Cpast = Cp + (dw*gamma)/dT; Cast = Cpast/Cp;            %s



RHX1 = (m1*Cp*exp(KHX1*AHX1/(m0*Cp)) - m0*Cp*exp(KHX1*AHX1/(m1*Cp)))/...        %s
        ( (m0*Cp*m1*Cp)*(exp(KHX1*AHX1/(m0*Cp)) - exp(KHX1*AHX1/(m1*Cp)) ) );

T2 = T1- (T1-T11)/(m0*Cp*RHX1);   %s


RHX2 = (m2*Cp*exp(KHX2*AHX2/(m0*Cp)) - m0*Cp*exp(KHX2*AHX2/(m2*Cp)))/...        %s
        ( (m0*Cp*m2*Cp)*(exp(KHX2*AHX2/(m0*Cp)) - exp(KHX2*AHX2/(m2*Cp)) ) );
RHR1 = 1/(m0*Cp) + 1/(KHR1*AHR1);                                               %s
RHR2 = (m0*Cp*exp(KHR2*AHR2/(m0*Cpast)) - m0*Cpast*exp(KHR2*AHR2/(m0*Cp)))/...
        ( (m0*Cpast*m0*Cp)*(exp(KHR2*AHR2/(m0*Cpast)) - exp(KHR2*AHR2/(m0*Cp)) ) );   %s
Rco = (m0*Cp*exp(Kco*Aco/(m0*Cpast)) - m0*Cpast*exp(Kco*Aco/(m0*Cp)))/...             $s
        ( (m0*Cpast*m0*Cp)*(exp(Kco*Aco/(m0*Cpast)) - exp(Kco*Aco/(m0*Cp)) ) );

C1 = Cast;

v = Ma*sqrt(1.4*287*Ta);      %velocidad crucero 

Cpc = Cp;           
Hu = 38729.75;      % valor calor?ico del combustible [kJ/kg]
EPSc = 0.6;         % combustion effectiveness of fuel

F(1) = thick*DHX*exp(Ce*Tauo*g/K) + KHX1*z1* ...
    exp( - (AHX1*KHX1*(m0-m1)/(Cp*m0*m1))) * ...
    (T1 - T11)*((m0-m1)^2)*(z2-1)/ ( Cast*Cp*m0 ...
     *nm*z2*(exp(Aco*Kco*(Cast-1)/(m0*Cast*Cp))-1)* ...
     (exp(AHR2*KHR2*(Cast-1)/(m0*Cast*Cp))-1) * ...
     (m0-m1*exp(-(AHX1*KHX1*(m0-m1))/(Cp*m0*m1)))^2 ) * ...
     (L3+Cast*L4+(L4+Cast*L3)*exp((Aco*Kco+AHR2*KHR2)*(Cast-1)/(m0*Cast*Cp)) ...
      -(L3+L4)*(exp(Aco*Kco*(Cast-1)/(m0*Cast*Cp)) - Cast * ...
      exp(AHR2*KHR2*(Cast-1)/(m0*Cast*Cp)))) + KHX1 * ...
      exp(-AHX1*KHX1*(m0-m1)/(Cp*m0*m2))*(T1-T11)*(m0-m1)^2 / ...
      ( AHR1*KHR1*m0*m2*nm*z2*Cp*(exp(-AHX2*KHX2*(m0-m2)/(Cp*m0*m2))-1) * ...
        (m0-m1*exp(-AHX1*KHX1*(m0-m2)/(Cp*m0*m2)))^2) * ( L2*m2*z1* ...
        (AHR1*KHR1+Cp*m0*z2)*(1-exp(-AHX2*KHX2*(m0-m2)/(Cp*m0*m2))) - ...
        -AHR1*KHR1*z1*z2*(L1*m0+L2*m2-m2*(L1+L2)* ...
       exp(-AHX2*KHX2*(m0-m2)/(Cp*m0*m2))) + AHR1*KHR1*L1*nm* ...
       z2*(1+z1)*(m0-m2));
   
F(2) = (Tast10+(T6-Tast4)*(Cast-1)-Q/(Cp*m0)+(nm-z1+nm*z1)* ...
       (T11*m1-T1*m0+T1*m1-T11*m1)/(m0*nm-m1*nm*exp(-AHX1*KHX1*(m0-m1)/(Cp*m0*m1))))* ...
       KHX2*L1*exp(AHX2*KHX2*(m0-m2)/(Cp*m0*m2))*((m0-m2)^2)/Cp*m0*(m2^2)* ...
       (exp(AHX2*KHX2*(m0-m2)/(Cp*m0*m2))-1)^2+thick*DHX*exp(Ce*Tauo*g/K);
   
F(3) = ( (Q/(m0*Cp)+Tast4*C1-T6*(C1-1)-Tast10)*Cp*(m0^2)*nm+(T11*(1-m0/m1)-T11)* ...
        Cp*m0*m1*z1 + (T6*(C1-1)+Tast10+T11*z1/nm-Tast4*C1-Q/(Cp*m0))*Cp*m0*m1*nm* ...
        exp(-AHX1*KHX1*(m0-m1)/(Cp*m0*m1))) * L2/(AHR1^2)*KHR1*nm*(m0-m1* ...
        exp(-AHX1*KHX1*(m0-m1)/(Cp*m0*m1))) + thick*DHX*exp(Ce*Tauo*g/K);
    
F(4) = -( (Q/(Cp*m1*z1)+m0*T1/(m1*z2*nm)-m0*Tast10/(m1*z1)-m0*T1/(m1*nm) + ... 
         Cast*m0*(Tp4-T6)/(m1*z1) + (T1-T11)/nm*(1-1/z2))*z1 + ...
         ( -Q/(Cp*m0) - T11*z1/(nm*z2) + Tast10 + T11/nm*z1 + Cast* (T6-Tp4) ) *   ...
          exp(-AHX1*KHX1*(m0-m1)/(Cp*m0*m1)) ) * KHR2*L3*exp(AHR2*KHR2*(Cast-1)/(Cast*Cp*m0)) *  ...
          ((1-1/Cast)^2)/( Cp*m0*((exp(AHR2*KHR2*(Cast-1)/(Cast*Cp*m0))-1)^2) * ...
          (m0/m1-exp(AHX1*KHX1*(m0-m1)/(Cp*m0*m1))) ) + thick*DHX*exp(Ce*Tauo*g/K);
      
F(5) = ( (Q/(Cp*m1*z1)+m0*T1/(m1*z2*nm)-m0*Tast10/(m1*z1)-m0*T1/(m1*nm) + ... 
         (T1-T11)/nm*(1-1/z2))*z1 + ...
         ( -Q/(Cp*m0) - T11*z1/(nm*z2) + Tast10 + T11/nm*z1 ) *   ...
          exp(-AHX1*KHX1*(m0-m1)/(Cp*m0*m1)) ) * Kco*L4*exp(Aco*Kco*(Cast-1)/(Cast*Cp*m0)) *  ...
          ((1-1/Cast)^2)/( Cp*m0*((exp(Aco*Kco*(Cast-1)/(Cast*Cp*m0))-1)^2) * ...
          (m0/m1-exp(AHX1*KHX1*(m0-m1)/(Cp*m0*m1))) ) + thick*DHX*exp(Ce*Tauo*g/K);
 
F(6) = ( L2*z1*(1/z2+Cp*m0*(AHR1*KHR1)-1)/nm -L1*(  z1  -0.5 * (z1-z1/nm+1) * (m0/m2 + (exp((AHX2*KHX2)*(1/(Cp*m0) - 1/(Cp*m2))) +1 )*(1-m0/m2)/ ...   %Revisar m0 en primeros términos
        (exp(AHX2*KHX2*(1/(Cp*m0) - 1/(Cp*m2))) -1 )   +1 ) + 1 )  -L4*z1*(z2-1)/(2*nm*z2) * ( 1/Cast + ( exp(-Aco*Kco* (1/(Cp*m0) - 1/(Cp*m0*Cast)) ) +1 ) * (1 - 1/Cast) / ...
         ( exp(-Aco*Kco* (1/(Cp*m0) - 1/(Cp*m0*Cast)) ) - 1 )  + 1  ) -  L3*z1*(z2-1)/(2*nm*z2) * ( 1/Cast - ( exp(-AHR2*KHR2* (1/(Cp*m0) - 1/(Cp*m0*Cast)) ) + 1 ) * (1-1/Cast) / ...
          ( exp(-AHR2*KHR2* (1/(Cp*m0) - 1/(Cp*m0*Cast)) ) - 1 ) + 1 )    )  *  ...                                     %ECUACIÓN A6 CORRESPONDIENTE A DJ/Dmo          
      (  -(Cp*m1*(T1-T11) )*( Cp*exp(AHX1*KHX1/(Cp*m1) ) + AHX1*KHX1*m1*exp(AHX1*KHX1/(Cp*m0))/(m0^2) )*( exp(AHX1*KHX1/(Cp*m0))  -  exp(AHX1*KHX1/(Cp*m1)) ) / ...
          ( Cp*m0*exp(AHX1*KHX1/(Cp*m1)) - Cp*m1*exp(AHX1*KHX1/(Cp*m0))  )^2  - AHX1*KHX1*m1* exp(AHX1*KHX1/(Cp*m0)) * (T1-T11) / ( (m0^2)* (  ...
            Cp*m0*exp(AHX1*KHX1/(Cp*m1)) - Cp*m1*exp(AHX1*KHX1/(Cp*m0))  )   )  )  +  ...                                %ECUACIÓN CORRESPONDIENTE A DT2/Dm0
          K/(Ce*g)*(exp(Ce*Tauo*g/K) - 1)*( Ce*v + T1*Cpc/(Hu*EPSc) )   -   ...   %Revisar T1 , v                           %ECUACIÓN CORRESPONDIENTE A DM/Dm0 REVISAR DATOS
          L1/2*( (T10 -T2*(z1-z1/nm + 1) + (T6-Tp4)*(Cast-1) - Q0/(Cp*m0) ) * ( 1/m2 - 1/m0*( exp(AHX2*KHX2* (1/(Cp*m0) - 1/(Cp*m2)) )  + 1 ) / ... 
          ( exp(AHX2*KHX2* (1/(Cp*m0) - 1/(Cp*m2)) )  - 1 ) + (( exp(AHX2*KHX2* (1/(Cp*m0) - 1/(Cp*m2)) )  + 1 ))*(1/m0-1/m2)/ ... 
          ( exp(AHX2*KHX2* (1/(Cp*m0) - 1/(Cp*m2)) )  - 1 )     - AHX2*KHX2*exp(AHX2*KHX2* (1/(Cp*m0) - 1/(Cp*m2)) ) * (1/(Cp*m0) -1/(Cp*m2))/ ...
          (m0*( exp(AHX2*KHX2* (1/(Cp*m0) - 1/(Cp*m2)) )  -1 ))   + AHX2*KHX2*exp(AHX2*KHX2* (1/(Cp*m0) - 1/(Cp*m2)) )*( exp(AHX2*KHX2* (1/(Cp*m0) - 1/(Cp*m2)) )  + 1 ) *  ...
          ( 1/(Cp*m0) - 1/(Cp*m2) )/(m0*(( exp(AHX2*KHX2* (1/(Cp*m0) - 1/(Cp*m2)) )  - 1 ))^2) )  + Q0/(Cp*m0)* ( 1/m2 + (exp(AHX2*KHX2* (1/(Cp*m0) - 1/(Cp*m2)) )  + 1 )* ...
          (1/m0 - 1/m2)/( exp(AHX2*KHX2* (1/(Cp*m0) - 1/(Cp*m2)) )  - 1 ) + 1 )   )  +    ...                  $ECUACIÓN CORRESPONDIENTE A Dl1f1/Dm0 
          L2*( Q0*(Cp*m0/(AHR1*KHR1)-1)/(Cp*m0^2) + Cp*(T10-Tp4*Cast+T6*(Cast-1) -Q0/(Cp*m0))/(AHR1*KHR1) + T2*Cp*z1/(AHR1*KHR1*nm) )   ...  $ECUACIÓN CORRESPONDIENTE A Dl2f2/Dm0 
          -L3*(Q0/(2*Cp*m0))*( 1/(m0*Cast) - ( exp(-AHR2*KHR2* (1/(Cp*m0) - 1/(Cp*m0*Cast)) )  + 1 )*(1/m0-1/(Cast*m0))/( exp(-AHR2*KHR2* (1/(Cp*m0) - 1/(Cp*m0*Cast))) - 1 ) +1 ) + ...
          L3/2*( T10 + Cast*(T6-Tp4) - Q0/(Cp*m0) + T2*z1*(z2-1)/(nm*z2) ) * ( ( exp(-AHR2*KHR2* (1/(Cp*m0) - 1/(Cp*m0*Cast)) )  + 1 )*(1/m0-1/(Cast*m0))/( exp(-AHR2*KHR2* (1/(Cp*m0) - 1/(Cp*m0*Cast))) - 1 ) ...
          - ( exp(-AHR2*KHR2* (1/(Cp*m0) - 1/(Cp*m0*Cast)) )  + 1 )*(1/m0-1/(Cast*m0))/( exp(-AHR2*KHR2* (1/(Cp*m0) - 1/(Cp*m0*Cast))) - 1 )  + ( AHR2*KHR2* exp(-AHR2*KHR2* (1/(Cp*m0) - 1/(Cp*m0*Cast)) )  )* ... 
          ((1/m0-1/(Cast*m0))^2)/( Cp*(exp(-AHR2*KHR2* (1/(Cp*m0) - 1/(Cp*m0*Cast))) - 1 ))  -  ( AHR2*KHR2* exp(-AHR2*KHR2* (1/(Cp*m0) - 1/(Cp*m0*Cast)) )  )* ... 
          ((1/m0-1/(Cast*m0))^2)*( exp(-AHR2*KHR2* (1/(Cp*m0) - 1/(Cp*m0*Cast)) )  + 1 )/( Cp*(exp(-AHR2*KHR2* (1/(Cp*m0) - 1/(Cp*m0*Cast))) - 1 )^2) ) ...  $ECUACIÓN CORRESPONDIENTE A Dl3f3/Dm0 
           -L4*(Q0/(2*Cp*m0))*( 1/(m0*Cast) + ( exp(-Aco*Kco* (1/(Cp*m0) - 1/(Cp*m0*Cast)) )  + 1 )*(1/m0-1/(Cast*m0))/( exp(-Aco*Kco* (1/(Cp*m0) - 1/(Cp*m0*Cast))) - 1 ) - 1 ) + ...
          L4/2*( T10 - Q0/(Cp*m0) + T2*z1*(z2-1)/(nm*z2) ) * ( ( exp(-Aco*Kco* (1/(Cp*m0) - 1/(Cp*m0*Cast)) )  + 1 )*(1/m0-1/(Cast*m0))/( exp(-Aco*Kco* (1/(Cp*m0) - 1/(Cp*m0*Cast))) - 1 ) ...
          - ( exp(-Aco*Kco* (1/(Cp*m0) - 1/(Cp*m0*Cast)) )  + 1 )*(1/m0-1/(Cast*m0))/( exp(-Aco*Kco* (1/(Cp*m0) - 1/(Cp*m0*Cast))) - 1 )  + ( Aco*Kco* exp(-Aco*Kco* (1/(Cp*m0) - 1/(Cp*m0*Cast)) )  )* ... 
          ((1/m0-1/(Cast*m0))^2)/( Cp*(exp(-Aco*Kco* (1/(Cp*m0) - 1/(Cp*m0*Cast))) - 1 ))  -  ( Aco*Kco* exp(-Aco*Kco* (1/(Cp*m0) - 1/(Cp*m0*Cast)) )  )* ... 
          ((1/m0-1/(Cast*m0))^2)*( exp(-Aco*Kco* (1/(Cp*m0) - 1/(Cp*m0*Cast)) )  + 1 )/( Cp*(exp(-Aco*Kco* (1/(Cp*m0) - 1/(Cp*m0*Cast))) - 1 )^2) ) + ...
           (T2*L4*z1*(z2-1)/(2*nm*z2))*( ( exp(-Aco*Kco* (1/(Cp*m0) - 1/(Cp*m0*Cast)) )  + 1 )*(1/m0-1/(Cast*m0))/( exp(-Aco*Kco* (1/(Cp*m0) - 1/(Cp*m0*Cast))) - 1 ) ...
          - ( exp(-Aco*Kco* (1/(Cp*m0) - 1/(Cp*m0*Cast)) )  + 1 )*(1/m0-1/(Cast*m0))/( exp(-Aco*Kco* (1/(Cp*m0) - 1/(Cp*m0*Cast))) - 1 )  + ( Aco*Kco* exp(-Aco*Kco* (1/(Cp*m0) - 1/(Cp*m0*Cast)) )  )* ... 
          ((1/m0-1/(Cast*m0))^2)/( Cp*(exp(-Aco*Kco* (1/(Cp*m0) - 1/(Cp*m0*Cast))) - 1 ))  -  ( Aco*Kco* exp(-Aco*Kco* (1/(Cp*m0) - 1/(Cp*m0*Cast)) )  )* ... 
          ((1/m0-1/(Cast*m0))^2)*( exp(-Aco*Kco* (1/(Cp*m0) - 1/(Cp*m0*Cast)) )  + 1 )/( Cp*(exp(-Aco*Kco* (1/(Cp*m0) - 1/(Cp*m0*Cast))) - 1 )^2) ) ;  ...  $ECUACIÓN CORRESPONDIENTE A Dl4f4/Dm0 
     
 F(7) = K*v/g*(exp(Ce*Tauo*g/K)-1) - z1*(exp(-AHX1*KHX1*(m0-m1)/(Cp*m0*m1))*(T1-T11)*(AHX1*KHX1*(m0-m1)+Cp*m0*m1*(1-exp(AHX1*KHX1*(m0-m1)/(Cp*m0*m1))))/ ...
        AHR1*KHR1*Cast*Cp*m1*nm*z2*(exp(AHR2*KHR2*(Cast-1)/(m0*Cast*Cp)) - 1 )*((m0-m1*exp(-AHX1*KHX1*(m0-m1)/(Cp*m0*m1)))^2) )* (AHR1*KHR1*(L3 + Cast*L2) -AHR1*KHR1*L3*z2*( ... 
        1 - Cast*exp(AHR2*KHR2*(Cast-1)/(m0*Cp*Cast)) ) + Cast*L2*z2*(m0*Cp - AHR1*KHR1)*( 1 - exp(AHR2*KHR2*(Cast-1)/(Cast*Cp*m0)) ) - AHR1*KHR1*Cast*(L2+L3)* ... 
        exp(AHR2*KHR2*(Cast-1)/(m0*Cp*Cast)) ) + L4*z1*(z2-1)*exp(-AHX1*KHX1*(m0-m1)/(Cp*m0*m1))*(T1-T11)*(Cast-exp(Aco*Kco*(Cast-1)/(Cp*Cast*m0)))* (AHX1*KHX1*(m0-m1) + ...
        Cp*m0*m1*(1-exp(AHX1*KHX1*(m0-m1)/(Cp*m0*m1)) ) )/(  Cast*Cp*m1*nm*z2*( exp(Aco*Kco*(Cast-1)/(Cp*m0*Cast)) - 1  )* (m0-m1*exp(-AHX1*KHX1*(m0-m1)/(Cp*m0*m1)))^2 ) - ...
        L1*exp(-AHX1*KHX1*(m0-m1)/(Cp*m0*m1))*(T1-T11)* (AHX1*KHX1*(m0-m1) + Cp*m0*m1*(1-exp(AHX1*KHX1*(m0-m1)/(Cp*m0*m1)) ) )/( Cp*m1* (m0-m1*exp(-AHX1*KHX1*(m0-m1)/(Cp*m0*m1)))^2 ) * ...     
        ( (nm-z1+nm*z1)*( m0-m2* exp(-AHX2*KHX2*(m0-m2)/(Cp*m0*m2)) )/( m2*nm*(exp(-AHX2*KHX2*(m0-m2)/(Cp*m0*m2)) -1 ) )  + (z1+1)  )  ;    ...  $ECUACIÓN CORRESPONDIENTE A DJ/Dm1
 
 F(8) = K*v/g*(exp(Ce*Tauo*g/K)-1) - L1*(exp(AHX2*KHX2*(m0-m2)/(Cp*m0*m2))*(AHX2*KHX2*(m0/m2-1)+Cp*m2*(1-exp(AHX2*KHX2*(m0-m2)/(Cp*m0*m2))))/ ...
        Cp*(m2^2)*((exp(AHX2*KHX2*(m0-m2)/(Cp*m0*m2)) -1 )^2) ) * (  Tast10 + (T6-Tast4)*(C1-1) - Q/Cp*m0 + (nm-z1+nm*z1)*((exp(-AHX1*KHX1*(m0-m1)/(Cp*m0*m1)) -1 ) * T11 + T1*(1-m0/m1) )/ ...
        m0/m1*nm - nm*exp(-AHX1*KHX1*(m0-m1)/(Cp*m0*m1)) )      ;

F(9) = (  ( T1 - (T1-T11)/(m0*Cp*RHX1) )*( z1+1-z1/nm ) + (T4r-T6)*(Cast-1) - (Tast10- Q0/(m0*Cp)) )*(m0*Cp*RHX2) -   (T1-(T1-T11)/(m0*Cp*RHX1))*(z1+1) + T12;

F(10) = ( (Tast10- Q0/(m0*Cp)) - Cast*T4r + T6*(Cast-1) )*(m0*Cp*RHR1-2) + z1/nm*(T1-(T1-T11)/(m0*Cp*RHX1))*(m0*Cp*RHR1-2+1/z2) - T4r;

F(11) = ( z1*(1-z2)/(z2*nm)*(T1-(T1-T11)/(m0*Cp*RHX1)) + Cast*(T4r-T6) - Tast10 + Q0/(m0*Cp)  )*(m0*Cp*RHR2) - T4r + T7;

F(12) = (Tast10 - Q0/(m0*Cp))*(1-m0*Cpast*Rco) + z1*(1-z2)/(z2*nm)*(T1-(T1-T11)/(m0*Cp*RHX1))*(m0*Cpast*Rco- Cast-1) + Cast*T6;


